<ion-header [translucent]="true">
  <ion-toolbar color="primary" class="custom-header">
    <ion-title class="header-title">
      <div class="shop-branding">
        <div class="logo-circle">üìä</div>
        <div class="shop-info">
          <h1>Reports & Analytics</h1>
          <p>Business insights & summaries</p>
        </div>
      </div>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="refreshData()">
        <ion-icon name="refresh" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="main-content">
  <!-- Quick Stats -->
  <div class="stats-bar">
    <div class="stat-item">
      <ion-icon name="trending-up-outline"></ion-icon>
      <span>‚Çπ{{totalSales}}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="trending-down-outline"></ion-icon>
      <span>‚Çπ{{totalExpenses}}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="analytics-outline"></ion-icon>
      <span>‚Çπ{{netProfit}}</span>
    </div>
    <div class="stat-item">
      <ion-icon name="calendar-outline"></ion-icon>
      <span>{{selectedPeriod}}</span>
    </div>
  </div>

  <!-- Main Action Cards -->
  <div class="action-grid">
    <div class="action-card primary" (click)="viewDailySummary()">
      <div class="card-icon">
        <ion-icon name="today"></ion-icon>
      </div>
      <div class="card-content">
        <h3>Daily Summary</h3>
        <p>Today's business overview</p>
      </div>
      <div class="card-arrow">
        <ion-icon name="chevron-forward"></ion-icon>
      </div>
    </div>

    <div class="action-card success" (click)="viewMonthlySummary()">
      <div class="card-icon">
        <ion-icon name="calendar"></ion-icon>
      </div>
      <div class="card-content">
        <h3>Monthly Report</h3>
        <p>Comprehensive monthly data</p>
      </div>
      <div class="card-arrow">
        <ion-icon name="chevron-forward"></ion-icon>
      </div>
    </div>

    <div class="action-card warning" (click)="viewLowStockAlert()">
      <div class="card-icon">
        <ion-icon name="warning"></ion-icon>
      </div>
      <div class="card-content">
        <h3>Stock Alerts</h3>
        <p>Low stock notifications</p>
      </div>
      <div class="card-arrow">
        <ion-icon name="chevron-forward"></ion-icon>
      </div>
    </div>

    <div class="action-card danger" (click)="exportReports()">
      <div class="card-icon">
        <ion-icon name="download"></ion-icon>
      </div>
      <div class="card-content">
        <h3>Export Data</h3>
        <p>Download reports</p>
      </div>
      <div class="card-arrow">
        <ion-icon name="chevron-forward"></ion-icon>
      </div>
    </div>
  </div>

  <!-- Period Selection -->
  <ion-card class="modern-card">
    <ion-card-header>
      <ion-card-title>üìÖ Select Report Period</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item lines="none">
        <ion-select [(ngModel)]="selectedPeriod" (ionChange)="loadReport()" placeholder="Select Period">
          <ion-select-option value="today">Today</ion-select-option>
          <ion-select-option value="week">This Week</ion-select-option>
          <ion-select-option value="month">This Month</ion-select-option>
          <ion-select-option value="custom">Custom Range</ion-select-option>
        </ion-select>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <!-- Summary Stats -->
  <div class="stats-grid">
    <ion-card class="stats-card">
      <ion-card-content>
        <div class="stat-header">
          <ion-icon name="trending-up" color="success"></ion-icon>
          <h3>Total Sales</h3>
        </div>
        <div class="stat-value">‚Çπ{{totalSales}}</div>
      </ion-card-content>
    </ion-card>
    
    <ion-card class="stats-card">
      <ion-card-content>
        <div class="stat-header">
          <ion-icon name="trending-down" color="danger"></ion-icon>
          <h3>Expenses</h3>
        </div>
        <div class="stat-value">‚Çπ{{totalExpenses}}</div>
      </ion-card-content>
    </ion-card>
    
    <ion-card class="stats-card">
      <ion-card-content>
        <div class="stat-header">
          <ion-icon name="analytics" color="primary"></ion-icon>
          <h3>Net Profit</h3>
        </div>
        <div class="stat-value">‚Çπ{{netProfit}}</div>
      </ion-card-content>
    </ion-card>
    
    <ion-card class="stats-card">
      <ion-card-content>
        <div class="stat-header">
          <ion-icon name="receipt" color="warning"></ion-icon>
          <h3>Transactions</h3>
        </div>
        <div class="stat-value">{{totalTransactions}}</div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Monthly Report -->
  <ion-card class="modern-card" *ngIf="monthlyReport">
    <ion-card-header>
      <ion-card-title>üìà Monthly Summary</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="summary-grid">
        <div class="summary-item">
          <h3>‚Çπ{{monthlyReport.totalDebit}}</h3>
          <p>Total Debit</p>
        </div>
        <div class="summary-item">
          <h3>‚Çπ{{monthlyReport.totalCredit}}</h3>
          <p>Total Credit</p>
        </div>
        <div class="summary-item">
          <h3>‚Çπ{{Math.abs(monthlyReport.totalBalance)}}</h3>
          <p>{{monthlyReport.totalBalance > 0 ? 'You owe' : 'Owed to you'}}</p>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Vendor Reports -->
  <ion-card class="modern-card" *ngIf="monthlyReport?.vendors.length">
    <ion-card-header>
      <ion-card-title>üè™ Vendor Reports</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item *ngFor="let vendor of monthlyReport.vendors">
          <ion-label>
            <h3>{{vendor.vendorName}}</h3>
            <p>Transactions: {{vendor.transactionCount}}</p>
          </ion-label>
          <div slot="end">
            <ion-chip [color]="vendor.balance > 0 ? 'danger' : 'success'">
              ‚Çπ{{Math.abs(vendor.balance)}}
            </ion-chip>
          </div>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <!-- No Data State -->
  <ion-card class="modern-card" *ngIf="!monthlyReport">
    <ion-card-content>
      <div class="no-data">
        <ion-icon name="analytics-outline"></ion-icon>
        <p>No report data available for the selected period. Start by recording some transactions!</p>
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>